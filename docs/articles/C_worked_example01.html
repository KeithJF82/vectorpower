<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Worked Example 1 - Data Creation • vectorpower</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Worked Example 1 - Data Creation">
<meta property="og:description" content="vectorpower">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vectorpower</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/A_package_intro.html">Package introduction</a>
    </li>
    <li>
      <a href="../articles/B_installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/C_worked_example01.html">Worked Example 1 - Data Creation</a>
    </li>
    <li>
      <a href="../articles/D_worked_example02.html">Worked Example 2 - Main Population Calculations</a>
    </li>
    <li>
      <a href="../articles/E_worked_example03.html">Worked Example 3 - Cohort Setup</a>
    </li>
    <li>
      <a href="../articles/F_worked_example04.html">Worked Example 4 - Cohort Simulation</a>
    </li>
    <li>
      <a href="../articles/G_worked_example05.html">Worked Example 5 - Combined Trial Modelling</a>
    </li>
    <li>
      <a href="../articles/H_worked_example06.html">Worked Example 6 - Power Calculations</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><link href="C_worked_example01_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="C_worked_example01_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Worked Example 1 - Data Creation</h1>
            
      
      
      <div class="hidden name"><code>C_worked_example01.Rmd</code></div>

    </div>

    
    
<p>This is an example of how to create a new dataset folder and populate it with equilibrium starting data for a range of baseline malaria level values. The R code used here can also be found in the create_dataset.R file in the vectorpower/inst/ folder.</p>
<p>First load the package (install it first if necessary as shown in the <a href="https://keithjf82.github.io/vectorpower/articles/B_installation.html">Installation article</a>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">vectorpower</span><span class="op">)</span></code></pre></div>
<p>To create a new data set, it is necessary to specify the files to be used to load the parameter values governing the malaria model. Three files are used:</p>
<p>-param_file, which contains the main set of model parameters along with the parameters used to calculate rainfall as a function of time (which controls the seasonality of malaria) -age_file, which specifies the age intervals used for the human population -het_file, which specifies the parameter values controlling biting heterogeneity</p>
<p>In this example, the three parameter files are located in the vectorpower repository itself and their locations input using the system.file() commaand.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">param_file</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/"</span>, <span class="st">"/param_examples/model_parameters_Mali.txt"</span>, package <span class="op">=</span> <span class="st">'vectorpower'</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">age_file</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/"</span>, <span class="st">"/param_examples/age_data_145.txt"</span>, package <span class="op">=</span> <span class="st">'vectorpower'</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">het_file</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/"</span>, <span class="st">"/param_examples/het_data_9.txt"</span>, package <span class="op">=</span> <span class="st">'vectorpower'</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>To specify online file locations, use url() as shown:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">param_file</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/KeithJF82/vectorpower/master/inst/extdata/param_examples/model_parameters_const.txt"</span><span class="op">)</span>
<span class="va">age_file</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/KeithJF82/vectorpower/master/inst/extdata/param_examples/age_data_145.txt"</span><span class="op">)</span>
<span class="va">het_file</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/KeithJF82/vectorpower/master/inst/extdata/param_examples/het_data_9.txt"</span><span class="op">)</span></code></pre></div>
<p>To load from a location on the computer where <strong>vectorpower</strong> is being run, give the file names and location in the hierarchy of data folders as shown below:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">input_folder</span><span class="op">=</span><span class="st">"C:/Users/YourName/Documents/GitHub/vectorpower/inst/extdata/param_examples"</span>
<span class="va">param_file</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">input_folder</span>,<span class="st">"model_parameters_Mali.txt"</span>,sep<span class="op">=</span><span class="st">"/"</span><span class="op">)</span>
<span class="va">age_file</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">input_folder</span>,<span class="st">"age_data_145.txt"</span>,sep<span class="op">=</span><span class="st">"/"</span><span class="op">)</span>
<span class="va">het_file</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">input_folder</span>,<span class="st">"het_data_9.txt"</span>,sep<span class="op">=</span><span class="st">"/"</span><span class="op">)</span></code></pre></div>
<p>The location of the folder where the new data set is to be created must also be specified. If a folder with the same already exists and contains an existing dataset, the dataset files in that folder will be overwritten. In this example, the output location is placed in the inst/extdata sub-folder in the <strong>vectorpower</strong> package folder (and will overwrite an existing, identical dataset).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">output_location</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,package<span class="op">=</span><span class="st">"vectorpower"</span><span class="op">)</span>
<span class="va">dataset_location</span> <span class="op">=</span> <span class="st">"DemoFolder1"</span>
<span class="va">dataset_folder</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">output_location</span>,<span class="va">dataset_location</span>,sep<span class="op">=</span><span class="st">"/"</span><span class="op">)</span></code></pre></div>
<p>To change the output, change output_location to another existing folder, e.g.:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">output_location</span> <span class="op">=</span> <span class="st">"C:/Users/YourName/Documents/VPDatasets"</span>
<span class="va">dataset_location</span> <span class="op">=</span> <span class="st">"Demo Folder 1"</span>
<span class="va">dataset_folder</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">output_location</span>,<span class="va">dataset_location</span>,sep<span class="op">=</span><span class="st">"/"</span><span class="op">)</span></code></pre></div>
<p>Ensure that folder names are separated by a “/”. Alternatively, substitute the entire folder name for dataset_folder, e.g.:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset_folder</span><span class="op">=</span><span class="st">"C:/Users/YourName/Documents/VPDatasets/DemoFolder1"</span></code></pre></div>
<p>The baseline malaria levels represented by the input data to go in the dataset are set by specifying a vector of values of steady-state annual entomological inoculation rate (EIR). These values will not exactly match the year-round EIR values represented by the data once the time-dependent model has been run; the final dataset will include a file specifying the year-round EIR at equilibrium under the time-dependent model.</p>
<p>In this example, the EIR values are between 50 and 100 infectious bites per person per year:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">EIR_values</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50.0</span>,<span class="fl">60.0</span>,<span class="fl">70.0</span>,<span class="fl">80.0</span>,<span class="fl">90.0</span>,<span class="fl">100.0</span><span class="op">)</span></code></pre></div>
<p>Next, the integer number of years (from 1-20) for which the time-dependent model should be run to reach equilibrium must be specified. The more years for which it is run, the more stable the equilibrium; if the equilibrium is less stable, the malaria level will vary more significantly from year to year in calculations if the model is run for multiple years. For most purposes, running for at least 5 years is sufficient. In this example, nyears is set to 1 for speed.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nyears</span><span class="op">=</span><span class="fl">10</span></code></pre></div>
<p>With all the parameters specified, the dataset_create function is run. This will first set initial conditions using steady-state calculations, then run the time-dependent model for the specified number of years to reach equilibrium. The results will be output as the dataset’s starting data. The year-round data output from the starting data (assuming no new interventions) will then be calculated and output as an aid to users of the dataset.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_data_folder.html">create_data_folder</a></span><span class="op">(</span>dataset_folder<span class="op">=</span><span class="va">dataset_folder</span>,param_file<span class="op">=</span><span class="va">param_file</span>,age_file<span class="op">=</span><span class="va">age_file</span>,het_file<span class="op">=</span><span class="va">het_file</span>,EIR_values<span class="op">=</span><span class="va">EIR_values</span>,nyears<span class="op">=</span><span class="va">nyears</span><span class="op">)</span></code></pre></div>
<p>[Code block above is not currently evaluated.]</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Keith Fraser.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
